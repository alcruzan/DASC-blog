---
title: Extinct Plants
author: ~
date: '2020-12-08'
slug: extinct-plants
categories: []
tags: []
---

<link href="index_files/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="index_files/anchor-sections/anchor-sections.js"></script>


<pre class="r"><code>library(ggplot2)
library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(stringr)
library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ tibble  2.1.3     ✓ purrr   0.3.3
## ✓ tidyr   1.0.0     ✓ forcats 0.4.0
## ✓ readr   1.3.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(here)</code></pre>
<pre><code>## here() starts at /home/alcruzan/DASC-blog</code></pre>
<pre class="r"><code>library(patchwork)</code></pre>
<pre class="r"><code>ep &lt;- read.csv(here(&quot;tidytuesday-master&quot;, &quot;data&quot;, &quot;2020&quot;, &quot;2020-08-18&quot;, &quot;plants.csv&quot;))

ap &lt;- read.csv(here(&quot;tidytuesday-master&quot;, &quot;data&quot;, &quot;2020&quot;, &quot;2020-08-18&quot;, &quot;actions.csv&quot;))</code></pre>
<pre class="r"><code>country_clean &lt;- ep %&gt;%
  filter(!is.na(country)) %&gt;%
  mutate(abbr = substr(country, 1,10)) %&gt;%
  group_by(country, red_list_category, abbr) %&gt;%
  summarize(Count = n()) %&gt;%
  filter(Count &gt;= 3)

c1 &lt;- ggplot(country_clean, aes(x= abbr, y=Count, color = red_list_category)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 90))

c2 &lt;- ggplot(ep, aes(x=continent, fill = group)) +
  geom_bar() 
  
c2 /
  c1</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="672" />
Question 1: Where are a majority of the plant extinctions?</p>
<p>The plant extinctions are mostly in the continent of Africa. This is about half
due to Madagascar having around 100 extinctions and also due to Tanzania having
about 25 extinctions themselves. In general, most plant extinctions have been
flowering plants. In Africa, there is also a decent portion of Cycad plants that
have gone extinct. In the Americas, it is mostly flowering plants that have gone
extinct. The high count in the Americas is mostly due to two countries: The
United States and the Ecuador which each account for 50 extinctions in their
continent. Europe has very few extinctions, but a sizable percent of their
extinctions is mosses.</p>
<pre class="r"><code>threat &lt;- ep %&gt;%
  group_by(year_last_seen) %&gt;%
  mutate(threat_level = (threat_AA + threat_BRU + threat_RCD + threat_ISGD + threat_EPM + threat_CC + threat_HID + threat_P + threat_TS + threat_NSM + threat_GE + threat_NA)) %&gt;%
  mutate(action_level = action_LWP + action_SM + action_LP + action_RM + action_EA + action_NA) %&gt;%
  filter(!is.na(year_last_seen)) %&gt;%
  ungroup(year_last_seen) %&gt;%
  mutate(year_last_seen = factor(year_last_seen, levels=c(&quot;Before 1900&quot;, &quot;1900-1919&quot;, &quot;1920-1939&quot;, &quot;1940-1959&quot;, &quot;1960-1979&quot;, &quot;1980-1999&quot;, &quot;2000-2020&quot;)))</code></pre>
<pre><code>## Warning: Factor `year_last_seen` contains implicit NA, consider using
## `forcats::fct_explicit_na`

## Warning: Factor `year_last_seen` contains implicit NA, consider using
## `forcats::fct_explicit_na`

## Warning: Factor `year_last_seen` contains implicit NA, consider using
## `forcats::fct_explicit_na`</code></pre>
<pre class="r"><code>line_graph &lt;- threat %&gt;%
  group_by(year_last_seen) %&gt;%
  summarize(Count = n())  

ggplot(data = threat, aes(x = year_last_seen, y = threat_level)) +
  geom_point(position = &quot;jitter&quot;, alpha = 0.6, aes(size = action_level, color = red_list_category)) + 
  theme(axis.text.x = element_text(angle = 90)) +
  scale_y_continuous(name = &quot;Threat Level&quot;, sec.axis = sec_axis(trans=~.*20, name = &quot;Number of Extinctions&quot;)) +
  geom_boxplot(data = line_graph, aes(x = year_last_seen, y = Count/15))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Question 2: Is there a trend in the time period of extinctions?</p>
<p>From 1900-1959, there were around 100 extinctions every 20 years. From 1960-1979,
there was a downward trend in extinctions that continued into 1980-1999. This
shows that</p>
<pre class="r"><code>actions &lt;- ap %&gt;%
  left_join(ep) %&gt;%
  filter(action_taken == 1) %&gt;%
  group_by(country) %&gt;%
  mutate(con_count = n()) %&gt;%
  filter(con_count &gt;= 12)</code></pre>
<pre><code>## Joining, by = c(&quot;binomial_name&quot;, &quot;country&quot;, &quot;continent&quot;, &quot;group&quot;, &quot;year_last_seen&quot;, &quot;red_list_category&quot;)</code></pre>
<pre class="r"><code>a1 &lt;- ggplot(actions, aes(x= action_type, fill = country))+
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90))

a2 &lt;- ggplot(actions, aes(x= action_type, fill = continent))+
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90))

a2 + a1</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
